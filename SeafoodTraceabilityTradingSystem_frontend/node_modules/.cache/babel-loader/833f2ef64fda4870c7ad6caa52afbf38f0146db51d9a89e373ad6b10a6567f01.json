{"ast":null,"code":"import { createVNode as _createVNode, resolveComponent as _resolveComponent, withKeys as _withKeys, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode } from \"vue\";\nimport _imports_0 from '@/images/Trash_icon.png';\nconst _hoisted_1 = {\n  class: \"my-haichao-page\"\n};\nconst _hoisted_2 = {\n  class: \"main-content\"\n};\nconst _hoisted_3 = {\n  class: \"search-container\"\n};\nconst _hoisted_4 = {\n  style: {\n    \"text-align\": \"start\",\n    \"font-weight\": \"bold\"\n  }\n};\nconst _hoisted_5 = {\n  style: {\n    \"font-weight\": \"normal\",\n    \"font-size\": \"20px\",\n    \"color\": \"#999\",\n    \"margin-left\": \"10px\"\n  }\n};\nconst _hoisted_6 = {\n  class: \"product-list\"\n};\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = [\"src\"];\nconst _hoisted_9 = {\n  class: \"product-info\"\n};\nconst _hoisted_10 = {\n  class: \"product-title\"\n};\nconst _hoisted_11 = {\n  class: \"product-price\"\n};\nconst _hoisted_12 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [_createVNode($setup[\"HeaderComponent\"]), _createVNode($setup[\"SidebarComponent\"], {\n    ref: \"sidebarComponent\"\n  }, null, 512 /* NEED_PATCH */), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_input, {\n    type: \"text\",\n    modelValue: $setup.searchQuery,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.searchQuery = $event),\n    placeholder: \"搜索宝贝...\",\n    class: \"search-input\",\n    onKeyup: _withKeys($setup.filterProducts, [\"enter\"])\n  }, null, 8 /* PROPS */, [\"modelValue\"]), _createElementVNode(\"button\", {\n    onClick: $setup.filterProducts,\n    class: \"search-button\"\n  }, _cache[1] || (_cache[1] = [_createElementVNode(\"a\", {\n    class: \"bi bi-search\",\n    style: {\n      \"color\": \"whitesmoke\"\n    }\n  }, null, -1 /* HOISTED */)]))]), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.filteredHistoricalData, (item, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      class: \"history-section\"\n    }, [_createElementVNode(\"h3\", _hoisted_4, [_createTextVNode(_toDisplayString($setup.formatTime(item.time)), 1 /* TEXT */), _createElementVNode(\"a\", _hoisted_5, _toDisplayString(item.data.length) + \"件宝贝\", 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_6, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(item.data, (product, idx) => {\n      return _openBlock(), _createElementBlock(\"div\", {\n        key: idx,\n        class: \"product-card\",\n        onClick: $event => $setup.handleProductDetail(product)\n      }, [_createElementVNode(\"img\", {\n        src: product.imageUrl,\n        alt: \"product image\",\n        class: \"product-image\"\n      }, null, 8 /* PROPS */, _hoisted_8), _createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"p\", _hoisted_10, _toDisplayString(product.title), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_11, \"￥\" + _toDisplayString(product.price), 1 /* TEXT */)]), _createElementVNode(\"div\", {\n        class: \"trash-icon\",\n        onClick: event => {\n          event.stopPropagation();\n          $setup.DeleteProduct(product);\n        }\n      }, [...(_cache[2] || (_cache[2] = [_createElementVNode(\"img\", {\n        src: _imports_0,\n        alt: \"Trash Icon\",\n        class: \"trash-image\"\n      }, null, -1 /* HOISTED */)]))], 8 /* PROPS */, _hoisted_12)], 8 /* PROPS */, _hoisted_7);\n    }), 128 /* KEYED_FRAGMENT */))])]);\n  }), 128 /* KEYED_FRAGMENT */))])]), _createVNode($setup[\"FooterComponent\"]), _createVNode($setup[\"RightWidgetComponent\"])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["_imports_0","class","style","_createElementBlock","_Fragment","_createElementVNode","_hoisted_1","_createVNode","$setup","ref","_hoisted_2","_hoisted_3","_component_el_input","type","modelValue","searchQuery","_cache","$event","placeholder","onKeyup","_withKeys","filterProducts","onClick","_renderList","filteredHistoricalData","item","index","key","_hoisted_4","_createTextVNode","_toDisplayString","formatTime","time","_hoisted_5","data","length","_hoisted_6","product","idx","handleProductDetail","src","imageUrl","alt","_hoisted_8","_hoisted_9","_hoisted_10","title","_hoisted_11","price","event","stopPropagation","DeleteProduct","_hoisted_12","_hoisted_7"],"sources":["D:\\Cache\\Java\\shopping\\shoppping_c_frontend\\src\\views\\FootMarkView.vue"],"sourcesContent":["<template>\r\n  <div class=\"my-haichao-page\">\r\n    <HeaderComponent/>\r\n    <SidebarComponent ref=\"sidebarComponent\"/>\r\n\r\n    <div class=\"main-content\">\r\n      <div class=\"search-container\">\r\n        <el-input type=\"text\" v-model=\"searchQuery\" placeholder=\"搜索宝贝...\" class=\"search-input\"\r\n                  @keyup.enter=\"filterProducts\"/>\r\n        <button @click=\"filterProducts\" class=\"search-button\">\r\n          <a class=\"bi bi-search\" style=\"color:whitesmoke;\"></a>\r\n        </button>\r\n      </div>\r\n      <div v-for=\"(item, index) in filteredHistoricalData\" :key=\"index\" class=\"history-section\">\r\n        <h3 style=\"text-align: start; font-weight: bold;\">{{ formatTime(item.time) }}<a\r\n            style=\"font-weight: normal; font-size: 20px; color: #999; margin-left: 10px;\">{{\r\n            item.data.length\r\n          }}件宝贝</a></h3>\r\n        <div class=\"product-list\">\r\n          <div v-for=\"(product, idx) in item.data\" :key=\"idx\" class=\"product-card\"\r\n               @click=\"handleProductDetail(product)\">\r\n            <img :src=\"product.imageUrl\" alt=\"product image\" class=\"product-image\"/>\r\n            <div class=\"product-info\">\r\n              <p class=\"product-title\">{{ product.title }}</p>\r\n              <p class=\"product-price\">￥{{ product.price }}</p>\r\n            </div>\r\n            <div class=\"trash-icon\" @click=\"(event) => { event.stopPropagation(); DeleteProduct(product); }\">\r\n              <img src=\"@/images/Trash_icon.png\" alt=\"Trash Icon\" class=\"trash-image\"/>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <FooterComponent/>\r\n  <RightWidgetComponent/>\r\n</template>\r\n\r\n<script setup>\r\nimport HeaderComponent from \"@/components/HeaderComponent.vue\";\r\nimport router from \"@/router\";\r\nimport FooterComponent from \"@/components/FooterComponent.vue\";\r\nimport RightWidgetComponent from \"@/components/RightWidgetComponent.vue\";\r\nimport SidebarComponent from \"@/components/SidebarComponent.vue\";\r\nimport {onMounted, ref} from 'vue';\r\nimport {ElMessage} from \"element-plus\";\r\nimport axios from 'axios';\r\nimport useUser from \"@/composables/useUser\";\r\n\r\nconst {UserInfoForm, initUserSession} = useUser()\r\n\r\nfunction handleProductDetail(product) {\r\n  router.push('/goodDetail?id=' + product.goodID);\r\n}\r\n\r\nconst historicalData = ref([]);\r\nconst searchQuery = ref('');\r\nconst filteredHistoricalData = ref([]);\r\n\r\nfunction filterProducts() {\r\n  // 检查搜索查询是否为空\r\n  if (!searchQuery.value.trim()) {\r\n    // 如果为空，直接展示所有历史数据\r\n    filteredHistoricalData.value = historicalData.value;\r\n    return;\r\n  }\r\n\r\n  // 根据关键词过滤历史数据\r\n  filteredHistoricalData.value = historicalData.value.map(item => ({\r\n    ...item,\r\n    data: item.data.filter(product => product.title.toLowerCase().includes(searchQuery.value))\r\n  })).filter(item => item.data.length > 0);\r\n}\r\n\r\n\r\nfunction formatTime(time) {\r\n  const currentDate = new Date();\r\n  const itemDate = new Date(time);\r\n\r\n  const isSameYear = itemDate.getFullYear() === currentDate.getFullYear();\r\n\r\n  // 创建新的日期对象来判断昨天和前天\r\n  const yesterday = new Date(currentDate);\r\n  yesterday.setDate(currentDate.getDate() - 1);\r\n\r\n  const beforeYesterday = new Date(currentDate);\r\n  beforeYesterday.setDate(currentDate.getDate() - 2);\r\n\r\n  const isToday = itemDate.toDateString() === currentDate.toDateString();\r\n  const isYesterday = itemDate.toDateString() === yesterday.toDateString();\r\n  const isBeforeYesterday = itemDate.toDateString() === beforeYesterday.toDateString();\r\n\r\n  if (isYesterday) {\r\n    return '昨天';\r\n  } else if (isBeforeYesterday) {\r\n    return '前天';\r\n  } else if (isToday) {\r\n    return '今天';\r\n  } else {\r\n    return isSameYear ? itemDate.toLocaleDateString('zh-CN', {\r\n      month: 'numeric',\r\n      day: 'numeric'\r\n    }).replace('年', '').replace('月', '/').replace('日', '') : time;\r\n  }\r\n}\r\n\r\nfunction transformData(backendData) {\r\n  const transformedData = [];\r\n  for (const [date, items] of Object.entries(backendData)) {\r\n    const data = items.map(item => ({\r\n      goodID: item.goodID,\r\n      title: item.goodName,\r\n      price: item.price,\r\n      imageUrl: item.showURL\r\n    }));\r\n    transformedData.push({\r\n      time: date,\r\n      data: data\r\n    });\r\n  }\r\n  return transformedData;\r\n}\r\n\r\nconst sidebarComponent = ref(null);\r\n\r\nfunction initSidebar() {\r\n  sidebarComponent.value.setActive(9);\r\n}\r\n\r\nasync function init() {\r\n  try {\r\n    const response = await axios.post('/api/good/findGoodFootMark', {\r\n      userId: UserInfoForm.value.id\r\n    }, {\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      withCredentials: true\r\n    })\r\n    if (response.data !== null) {\r\n      historicalData.value = transformData(response.data);\r\n      filteredHistoricalData.value = historicalData.value;\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('获取历史记录失败');\r\n  }\r\n}\r\n\r\nasync function DeleteProduct(product) {\r\n  try {\r\n    const response = await axios.post('/api/good/deleteGoodFootMark', {\r\n      userId: UserInfoForm.value.id,\r\n      goodId: product.goodID\r\n    }, {\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      withCredentials: true\r\n    })\r\n    if (response.data.code === 200) {\r\n      ElMessage.success('删除成功');\r\n      await init();\r\n    } else {\r\n      ElMessage.error('删除失败');\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('删除失败');\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  initUserSession();\r\n  await init();\r\n  initSidebar();\r\n});\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.my-haichao-page {\r\n  display: flex;\r\n  flex-direction: row;\r\n  font-family: Arial, sans-serif;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.main-content {\r\n  flex: 1;\r\n  padding: 20px;\r\n  background-color: #ffffff;\r\n  margin-top: 90px;\r\n  min-height: calc(90vh - 100px);\r\n}\r\n\r\n.search-box {\r\n  margin-bottom: 20px;\r\n  padding: 10px;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.history-section {\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.product-list {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 20px;\r\n}\r\n\r\n.product-list > div {\r\n  flex-basis: calc(20% - 20px); /* 每个子元素占据 25% 的宽度，减去间距 */\r\n}\r\n\r\n.product-card {\r\n  width: 200px;\r\n  background-color: #fff;\r\n  border: 1px solid #eaeaea;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  overflow: hidden;\r\n  transition: transform 0.3s;\r\n  position: relative;\r\n}\r\n\r\n.product-card:hover {\r\n  transform: translateY(-5px);\r\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);\r\n  border: 1px solid #e02020;\r\n}\r\n\r\n.product-image {\r\n  width: 100%;\r\n  height: 75%;\r\n  object-fit: cover;\r\n  border-radius: 8px;\r\n}\r\n\r\n.trash-icon {\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  display: none; /* 默认隐藏 */\r\n  background-color: rgba(0, 0, 0, 0.6);\r\n  border-radius: 0 0 0 8px;\r\n}\r\n\r\n.product-card:hover .trash-icon {\r\n  display: block; /* 悬浮时显示 */\r\n}\r\n\r\n.trash-image {\r\n  width: 30px;\r\n  height: 30px;\r\n  padding: 5px;\r\n  /* 其他样式 */\r\n}\r\n\r\n.product-info {\r\n  padding: 10px;\r\n}\r\n\r\n.product-title {\r\n  font-size: 14px;\r\n  color: #333;\r\n  margin: 5px 0;\r\n}\r\n\r\n.product-price {\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  color: #ff0000;\r\n}\r\n\r\n.search-container {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n  padding-right: 20px;\r\n}\r\n\r\n.search-input {\r\n  padding: 10px;\r\n  font-size: 16px;\r\n  border: 2px solid #ccc;\r\n  border-radius: 8px 0 0 8px;\r\n  outline: none;\r\n  width: 200px;\r\n  border-right: none;\r\n}\r\n\r\n.search-input:hover {\r\n  border-color: #e02020;\r\n}\r\n\r\n.search-button {\r\n  padding: 10px 20px;\r\n  background-color: #e02020;\r\n  color: white;\r\n  font-size: 16px;\r\n  border: 2px solid #e02020;\r\n  border-radius: 0 8px 8px 0;\r\n  cursor: pointer;\r\n  font-weight: bold;\r\n}\r\n\r\n.search-button:hover {\r\n  background-color: #c21a1a;\r\n  border-color: #c21a1a;\r\n}\r\n\r\n.night-mode {\r\n  background-color: #2e2e2e;\r\n  color: #e0e0e0;\r\n}\r\n\r\n.night-mode .body {\r\n  background-color: #2e2e2e;\r\n}\r\n\r\n.night-mode .header {\r\n  background-color: #3c3c3c;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.night-mode .sidebar {\r\n  background-color: #3c3c3c;\r\n  border-right: 1px solid #444;\r\n}\r\n\r\n.night-mode .sidebar .el-menu-item {\r\n  background-color: #3c3c3c;\r\n  color: #e0e0e0;\r\n}\r\n\r\n.night-mode .sidebar.el-menu-item:hover {\r\n  background-color: #4c4c4c;\r\n}\r\n\r\n.night-mode .main-content,\r\n.night-mode .profile-section,\r\n.night-mode .order-section,\r\n.night-mode .logistics-section,\r\n.night-mode .logistics-item,\r\n.night-mode .profile-card,\r\n.night-mode .promotion-card {\r\n  background-color: #3c3c3c;\r\n  color: #e0e0e0;\r\n}\r\n\r\n.night-mode .order-icon,\r\n.night-mode .logistics-action {\r\n  color: #ffa500;\r\n}\r\n\r\n.night-mode .right-widget {\r\n  background-color: #3c3c3c;\r\n  box-shadow: -2px 0 8px rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.night-mode .footer {\r\n  background-color: #2e2e2e;\r\n  border-top: 1px solid #333;\r\n}\r\n\r\n.night-mode .footer-links a {\r\n  color: #ffffff;\r\n}\r\n\r\n.night-mode .footer-links a:hover {\r\n  color: #e02020;\r\n}\r\n\r\n.night-mode .product-card {\r\n  background-color: #3c3c3c;\r\n}\r\n\r\n.night-mode .search-input {\r\n  background-color: #3c3c3c;\r\n  color: #e0e0e0;\r\n}\r\n\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}