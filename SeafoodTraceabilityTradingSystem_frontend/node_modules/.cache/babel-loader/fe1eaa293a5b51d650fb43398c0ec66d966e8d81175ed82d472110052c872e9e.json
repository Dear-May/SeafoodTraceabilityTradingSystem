{"ast":null,"code":"import { createVNode as _createVNode, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelText as _vModelText, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  class: \"my-haichao-page\"\n};\nconst _hoisted_2 = {\n  class: \"live-stream-container\"\n};\nconst _hoisted_3 = {\n  class: \"header bg-light d-flex align-items-center p-3 shadow-sm row\"\n};\nconst _hoisted_4 = {\n  class: \"col-8\"\n};\nconst _hoisted_5 = {\n  class: \"content-container d-flex\"\n};\nconst _hoisted_6 = {\n  class: \"side-panel bg-light p-3\"\n};\nconst _hoisted_7 = {\n  class: \"online-users mb-4\"\n};\nconst _hoisted_8 = {\n  class: \"text-danger\"\n};\nconst _hoisted_9 = {\n  class: \"list-unstyled\"\n};\nconst _hoisted_10 = [\"src\"];\nconst _hoisted_11 = {\n  class: \"chat-section\"\n};\nconst _hoisted_12 = {\n  class: \"chat-messages border rounded p-2 mb-3\"\n};\nconst _hoisted_13 = [\"src\"];\nconst _hoisted_14 = {\n  class: \"mb-1\"\n};\nconst _hoisted_15 = {\n  class: \"text-muted mb-0\"\n};\nconst _hoisted_16 = {\n  class: \"input-group\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_button = _resolveComponent(\"el-button\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [_createVNode($setup[\"HeaderComponent\"]), _createElementVNode(\"div\", _hoisted_2, [_createCommentVNode(\" 头部信息 \"), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_el_button, {\n    ref: \"button_one\",\n    onClick: _ctx.publish,\n    type: \"primary\",\n    size: \"large\",\n    disabled: _ctx.isPublishing\n  }, {\n    default: _withCtx(() => _cache[2] || (_cache[2] = [_createTextVNode(\" 开始直播 \")])),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\", \"disabled\"]), _createVNode(_component_el_button, {\n    ref: \"button_two\",\n    onClick: _ctx.close,\n    type: \"danger\",\n    size: \"large\",\n    disabled: !_ctx.isPublishing\n  }, {\n    default: _withCtx(() => _cache[3] || (_cache[3] = [_createTextVNode(\" 停止直播 \")])),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\", \"disabled\"])])]), _createCommentVNode(\" 主体内容 \"), _createElementVNode(\"div\", _hoisted_5, [_createCommentVNode(\" 视频播放区 \"), _cache[5] || (_cache[5] = _createElementVNode(\"div\", {\n    class: \"video-section flex-grow-1\"\n  }, [_createElementVNode(\"video\", {\n    id: \"video\",\n    autoplay: \"\",\n    playsinline: \"\",\n    muted: \"\",\n    class: \"video-element\",\n    style: {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"object-fit\": \"cover\"\n    }\n  })], -1 /* HOISTED */)), _createCommentVNode(\" 在线用户和聊天区域 \"), _createElementVNode(\"div\", _hoisted_6, [_createCommentVNode(\" 在线用户列表 \"), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"h6\", _hoisted_8, \"在线人员 (\" + _toDisplayString(_ctx.onlineUsers.length) + \")\", 1 /* TEXT */), _createElementVNode(\"ul\", _hoisted_9, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.onlineUsers, (user, index) => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: index,\n      class: \"d-flex align-items-center mb-2\"\n    }, [_createElementVNode(\"img\", {\n      class: \"user-avatar-sm rounded-circle me-2\",\n      src: user.avatar,\n      alt: \"用户头像\"\n    }, null, 8 /* PROPS */, _hoisted_10), _createElementVNode(\"span\", null, _toDisplayString(user.name), 1 /* TEXT */)]);\n  }), 128 /* KEYED_FRAGMENT */))])]), _createCommentVNode(\" 聊天区 \"), _createElementVNode(\"div\", _hoisted_11, [_cache[4] || (_cache[4] = _createElementVNode(\"h6\", {\n    class: \"text-primary\"\n  }, \"聊天区\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_12, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.chatMessages, (message, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      class: \"d-flex align-items-start mb-2\"\n    }, [_createElementVNode(\"img\", {\n      class: \"user-avatar-sm rounded-circle me-2\",\n      src: message.avatar,\n      alt: \"用户头像\"\n    }, null, 8 /* PROPS */, _hoisted_13), _createElementVNode(\"div\", null, [_createElementVNode(\"p\", _hoisted_14, [_createElementVNode(\"strong\", null, _toDisplayString(message.sender), 1 /* TEXT */)]), _createElementVNode(\"p\", _hoisted_15, _toDisplayString(message.content), 1 /* TEXT */)])]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createCommentVNode(\" 聊天输入框 \"), _createElementVNode(\"div\", _hoisted_16, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _ctx.chatInput = $event),\n    class: \"form-control\",\n    placeholder: \"输入50字以内聊天内容~\",\n    maxlength: \"50\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, _ctx.chatInput]]), _createElementVNode(\"button\", {\n    class: \"btn btn-danger\",\n    onClick: _cache[1] || (_cache[1] = (...args) => _ctx.sendMessage && _ctx.sendMessage(...args))\n  }, \"发送\")])])])])])]), _createVNode($setup[\"FooterComponent\"]), _createVNode($setup[\"RightWidgetComponent\"])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["class","_createElementBlock","_Fragment","_createElementVNode","_hoisted_1","_createVNode","$setup","_hoisted_2","_createCommentVNode","_hoisted_3","_hoisted_4","_component_el_button","ref","onClick","_ctx","publish","type","size","disabled","isPublishing","default","_withCtx","_cache","_createTextVNode","_","close","_hoisted_5","id","autoplay","playsinline","muted","style","_hoisted_6","_hoisted_7","_hoisted_8","_toDisplayString","onlineUsers","length","_hoisted_9","_renderList","user","index","key","src","avatar","alt","_hoisted_10","name","_hoisted_11","_hoisted_12","chatMessages","message","_hoisted_13","_hoisted_14","sender","_hoisted_15","content","_hoisted_16","$event","chatInput","placeholder","maxlength","args","sendMessage"],"sources":["D:\\Cache\\Java\\shopping\\shoppping_c_frontend\\src\\views\\LiveView.vue"],"sourcesContent":["<template>\r\n  <div class=\"my-haichao-page\">\r\n    <HeaderComponent/>\r\n    <div class=\"live-stream-container\">\r\n      <!-- 头部信息 -->\r\n      <div class=\"header bg-light d-flex align-items-center p-3 shadow-sm row\">\r\n        <div class=\"col-8\">\r\n          <el-button\r\n              ref=\"button_one\"\r\n              @click=\"publish\"\r\n              type=\"primary\"\r\n              size=\"large\"\r\n              :disabled=\"isPublishing\"\r\n          >\r\n            开始直播\r\n          </el-button>\r\n          <el-button\r\n              ref=\"button_two\"\r\n              @click=\"close\"\r\n              type=\"danger\"\r\n              size=\"large\"\r\n              :disabled=\"!isPublishing\"\r\n          >\r\n            停止直播\r\n          </el-button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 主体内容 -->\r\n      <div class=\"content-container d-flex\">\r\n        <!-- 视频播放区 -->\r\n        <div class=\"video-section flex-grow-1\">\r\n          <video id=\"video\" autoplay playsinline muted class=\"video-element\"\r\n                 style=\"width: 100%; height: 100%; object-fit: cover;\"></video>\r\n        </div>\r\n\r\n        <!-- 在线用户和聊天区域 -->\r\n        <div class=\"side-panel bg-light p-3\">\r\n          <!-- 在线用户列表 -->\r\n          <div class=\"online-users mb-4\">\r\n            <h6 class=\"text-danger\">在线人员 ({{ onlineUsers.length }})</h6>\r\n            <ul class=\"list-unstyled\">\r\n              <li\r\n                  v-for=\"(user, index) in onlineUsers\"\r\n                  :key=\"index\"\r\n                  class=\"d-flex align-items-center mb-2\"\r\n              >\r\n                <img\r\n                    class=\"user-avatar-sm rounded-circle me-2\"\r\n                    :src=\"user.avatar\"\r\n                    alt=\"用户头像\"\r\n                />\r\n                <span>{{ user.name }}</span>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n\r\n          <!-- 聊天区 -->\r\n          <div class=\"chat-section\">\r\n            <h6 class=\"text-primary\">聊天区</h6>\r\n            <div class=\"chat-messages border rounded p-2 mb-3\">\r\n              <div\r\n                  v-for=\"(message, index) in chatMessages\"\r\n                  :key=\"index\"\r\n                  class=\"d-flex align-items-start mb-2\"\r\n              >\r\n                <img\r\n                    class=\"user-avatar-sm rounded-circle me-2\"\r\n                    :src=\"message.avatar\"\r\n                    alt=\"用户头像\"\r\n                />\r\n                <div>\r\n                  <p class=\"mb-1\"><strong>{{ message.sender }}</strong></p>\r\n                  <p class=\"text-muted mb-0\">{{ message.content }}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- 聊天输入框 -->\r\n            <div class=\"input-group\">\r\n              <input\r\n                  type=\"text\"\r\n                  v-model=\"chatInput\"\r\n                  class=\"form-control\"\r\n                  placeholder=\"输入50字以内聊天内容~\"\r\n                  maxlength=\"50\"\r\n              />\r\n              <button class=\"btn btn-danger\" @click=\"sendMessage\">发送</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <FooterComponent/>\r\n  <RightWidgetComponent></RightWidgetComponent>\r\n</template>\r\n\r\n<script setup>\r\nimport HeaderComponent from \"@/components/HeaderComponent.vue\";\r\nimport RightWidgetComponent from \"@/components/RightWidgetComponent.vue\";\r\nimport FooterComponent from \"@/components/FooterComponent.vue\";\r\nimport useUser from \"@/composables/useUser\";\r\nimport {onMounted} from \"vue\";\r\n\r\nconst {UserInfoForm, initUserSession} = useUser()\r\n\r\nasync function play() {\r\n  const httpURL = \"http://localhost:1985/rtc/v1/play/\";\r\n  const webRTCURL = \"webRTC://localhost/live/888\";\r\n  const localPc = new RTCPeerConnection();\r\n  const stream = new MediaStream();\r\n  const videoElement2 = document.querySelector(\"#video2\");\r\n\r\n  localPc.ontrack = (event) => {\r\n    stream.addTrack(event.track);\r\n    console.log(event.track);\r\n    videoElement2.srcObject = stream;\r\n  };\r\n\r\n  localPc.addTransceiver(\"audio\", {direction: \"recvonly\"});\r\n  localPc.addTransceiver(\"video\", {direction: \"recvonly\"});\r\n\r\n  const offer = await localPc.createOffer();\r\n  await localPc.setLocalDescription(offer);\r\n  const data = {\r\n    \"api\": httpURL,\r\n    \"streamurl\": webRTCURL,\r\n    \"sdp\": offer.sdp\r\n  };\r\n\r\n  httpApi(httpURL, data).then(async (data) => {\r\n    console.log(\"answer\", data);\r\n    await localPc.setRemoteDescription(new RTCSessionDescription({type: 'answer', sdp: data.sdp}));\r\n    button_five.disabled = true;\r\n  }).catch((data) => {\r\n    if (data.code === 400) {\r\n      console.log(\"SDP交换失败\");\r\n    }\r\n  });\r\n}\r\n\r\nonMounted(() => {\r\n  initUserSession()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.my-haichao-page {\r\n  display: flex;\r\n  flex-direction: row;\r\n  font-family: Arial, sans-serif;\r\n  background-color: #f5f5f5;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}