{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport HeaderComponent from \"@/components/HeaderComponent.vue\";\nimport SidebarComponent from \"@/components/SidebarComponent.vue\";\nimport FooterComponent from \"@/components/FooterComponent.vue\";\nimport RightWidgetComponent from \"@/components/RightWidgetComponent.vue\";\nimport { onMounted, ref } from \"vue\";\nimport router from \"@/router\";\nimport axios from \"axios\";\nimport { ElMessage } from \"element-plus\";\nimport useUser from \"@/composables/useUser\";\nexport default {\n  __name: 'MyCommentView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const {\n      UserInfoForm,\n      initUserSession\n    } = useUser();\n    const sidebarComponent = ref(null);\n    function initSidebar() {\n      sidebarComponent.value.setActive(10);\n    }\n    const commentInfo = ref([]);\n    async function initCommentInfo() {\n      try {\n        const response = await axios.post(\"/api/pay/comment/getComment\", {\n          userId: UserInfoForm.value.id\n        }, {\n          headers: {\n            'Content-Type': 'application/json;charset=UTF-8'\n          },\n          withCredentials: true\n        });\n        if (response.data != null) {\n          commentInfo.value = response.data;\n        } else {\n          ElMessage.error('获取评论失败，请稍后再试');\n        }\n      } catch (error) {\n        ElMessage.error('获取评论失败，请稍后再试');\n      }\n    }\n    function formatDate(dateString) {\n      const date = new Date(dateString);\n      const year = date.getFullYear();\n      const month = String(date.getMonth() + 1).padStart(2, '0'); // 月份需加1，并补零\n      const day = String(date.getDate()).padStart(2, '0'); // 补零\n\n      return `${year}-${month}-${day}`;\n    }\n    async function handleDeleteComment(commentId) {\n      try {\n        const response = await axios.post(\"/api/pay/comment/deleteComment\", {\n          userId: UserInfoForm.value.id,\n          commentId: commentId\n        }, {\n          headers: {\n            'Content-Type': 'application/json;charset=UTF-8'\n          },\n          withCredentials: true\n        });\n        if (response.data.code === 200) {\n          ElMessage.success('删除成功');\n          await initCommentInfo();\n        } else {\n          ElMessage.error('删除失败，请稍后再试');\n        }\n      } catch (error) {\n        ElMessage.error('删除失败，请稍后再试');\n      }\n    }\n    function handleShop(id) {\n      router.push('/shop?shopId=' + id);\n    }\n    function routerToProduct(goodId) {\n      router.push('/goodDetail?id=' + goodId);\n    }\n    onMounted(async () => {\n      initUserSession();\n      initSidebar();\n      await initCommentInfo();\n    });\n    const __returned__ = {\n      UserInfoForm,\n      initUserSession,\n      sidebarComponent,\n      initSidebar,\n      commentInfo,\n      initCommentInfo,\n      formatDate,\n      handleDeleteComment,\n      handleShop,\n      routerToProduct,\n      HeaderComponent,\n      SidebarComponent,\n      FooterComponent,\n      RightWidgetComponent,\n      onMounted,\n      ref,\n      get router() {\n        return router;\n      },\n      get axios() {\n        return axios;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get useUser() {\n        return useUser;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["HeaderComponent","SidebarComponent","FooterComponent","RightWidgetComponent","onMounted","ref","router","axios","ElMessage","useUser","UserInfoForm","initUserSession","sidebarComponent","initSidebar","value","setActive","commentInfo","initCommentInfo","response","post","userId","id","headers","withCredentials","data","error","formatDate","dateString","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","handleDeleteComment","commentId","code","success","handleShop","push","routerToProduct","goodId"],"sources":["D:/Cache/Java/shopping/shoppping_c_frontend/src/views/MyCommentView.vue"],"sourcesContent":["<template>\r\n  <div class=\"my-haichao-page\">\r\n    <HeaderComponent/>\r\n    <SidebarComponent ref=\"sidebarComponent\"/>\r\n    <div class=\"main-content\">\r\n      <header class=\"header\">\r\n        <div class=\"comment-header\">\r\n          <span class=\"store-name\">评分</span>\r\n          <span class=\"product-info\">评论</span>\r\n          <span class=\"price-info\">商家</span>\r\n          <span class=\"quantity-info\">商品信息</span>\r\n          <span class=\"subtotal-info\">操作</span>\r\n        </div>\r\n      </header>\r\n      <div class=\"comment-list\">\r\n        <div v-for=\"(item, index) in commentInfo\" :key=\"index\" class=\"comment-item\">\r\n          <div class=\"comment-score\">\r\n            <el-rate\r\n                v-model=\"item.rate\"\r\n                disabled\r\n                show-score\r\n                text-color=\"#ff9900\"\r\n            />\r\n          </div>\r\n          <div class=\"comment-info\">\r\n            <div class=\"comment-content\">{{ item.content }}</div>\r\n            <div class=\"comment-images\" v-if=\"item.images!== null\">\r\n              <div v-for=\"(image, index) in item.images\" :key=\"index\">\r\n                <img :src=\"image\" alt=\"\" width=\"50px\" height=\"50px\"/>\r\n              </div>\r\n            </div>\r\n            <div class=\"comment-time\">{{ formatDate(item.time) }}</div>\r\n          </div>\r\n          <div class=\"comment-store\">\r\n            <div class=\"store-avatar\">\r\n              <img :src=\"item.storeAvatar\" alt=\"\" width=\"50px\" height=\"50px\"/>\r\n            </div>\r\n            <div class=\"store-name\" @click=\"handleShop(item.shopId)\">{{ item.shopName }}</div>\r\n          </div>\r\n          <div class=\"comment-product\">\r\n            <div class=\"product-name\" @click=\"routerToProduct(item.goodId)\">{{ item.goodName }}</div>\r\n            <div class=\"product-price\">￥{{ item.totalPrice }}</div>\r\n          </div>\r\n          <div class=\"comment-work\">\r\n            <el-button type=\"text\" @click=\"handleDeleteComment(item.commentId)\">删除</el-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <FooterComponent/>\r\n  <RightWidgetComponent/>\r\n</template>\r\n\r\n<script setup>\r\nimport HeaderComponent from \"@/components/HeaderComponent.vue\";\r\nimport SidebarComponent from \"@/components/SidebarComponent.vue\";\r\nimport FooterComponent from \"@/components/FooterComponent.vue\";\r\nimport RightWidgetComponent from \"@/components/RightWidgetComponent.vue\";\r\nimport {onMounted, ref} from \"vue\";\r\nimport router from \"@/router\";\r\nimport axios from \"axios\";\r\nimport {ElMessage} from \"element-plus\";\r\nimport useUser from \"@/composables/useUser\";\r\n\r\nconst {UserInfoForm, initUserSession} = useUser()\r\n\r\nconst sidebarComponent = ref(null);\r\n\r\nfunction initSidebar() {\r\n  sidebarComponent.value.setActive(10);\r\n}\r\n\r\nconst commentInfo = ref([]);\r\n\r\nasync function initCommentInfo() {\r\n  try {\r\n    const response = await axios.post(\"/api/pay/comment/getComment\", {\r\n      userId: UserInfoForm.value.id,\r\n    }, {\r\n      headers: {\r\n        'Content-Type': 'application/json;charset=UTF-8'\r\n      },\r\n      withCredentials: true\r\n    })\r\n    if (response.data != null) {\r\n      commentInfo.value = response.data;\r\n    } else {\r\n      ElMessage.error('获取评论失败，请稍后再试');\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('获取评论失败，请稍后再试');\r\n  }\r\n}\r\n\r\nfunction formatDate(dateString) {\r\n  const date = new Date(dateString);\r\n  const year = date.getFullYear();\r\n  const month = String(date.getMonth() + 1).padStart(2, '0'); // 月份需加1，并补零\r\n  const day = String(date.getDate()).padStart(2, '0'); // 补零\r\n\r\n  return `${year}-${month}-${day}`;\r\n}\r\n\r\nasync function handleDeleteComment(commentId) {\r\n  try {\r\n    const response = await axios.post(\"/api/pay/comment/deleteComment\", {\r\n      userId: UserInfoForm.value.id,\r\n      commentId: commentId,\r\n    }, {\r\n      headers: {\r\n        'Content-Type': 'application/json;charset=UTF-8'\r\n      },\r\n      withCredentials: true\r\n    })\r\n    if (response.data.code === 200) {\r\n      ElMessage.success('删除成功');\r\n      await initCommentInfo();\r\n    } else {\r\n      ElMessage.error('删除失败，请稍后再试');\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('删除失败，请稍后再试');\r\n  }\r\n}\r\n\r\nfunction handleShop(id) {\r\n  router.push('/shop?shopId=' + id);\r\n}\r\n\r\nfunction routerToProduct(goodId) {\r\n  router.push('/goodDetail?id=' + goodId);\r\n}\r\n\r\nonMounted(async () => {\r\n  initUserSession();\r\n  initSidebar();\r\n  await initCommentInfo();\r\n});\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.my-haichao-page {\r\n  display: flex;\r\n  flex-direction: row;\r\n  font-family: Arial, sans-serif;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.main-content {\r\n  flex: 1;\r\n  padding: 20px;\r\n  background-color: #ffffff;\r\n  margin-top: 90px;\r\n  min-height: calc(90vh - 100px);\r\n\r\n  .comment-header {\r\n    display: grid;\r\n    grid-template-columns: 10% 35% 15% 25% 15%;\r\n    padding: 10px;\r\n    font-weight: bold;\r\n    color: #555;\r\n    border-bottom: 1px solid #ddd;\r\n    text-align: center;\r\n  }\r\n\r\n  .comment-item {\r\n    width: 100%;\r\n    display: grid;\r\n    grid-template-columns: 10% 35% 15% 25% 15%;\r\n    align-items: center;\r\n    padding: 15px 20px;\r\n    border-bottom: 1px solid #e0e0e0;\r\n    text-align: center;\r\n\r\n    .comment-score {\r\n      margin-top: 10px;\r\n      text-align: center;\r\n    }\r\n\r\n    .comment-info {\r\n      margin-top: 10px;\r\n      font-size: 14px;\r\n      color: #333;\r\n\r\n      .comment-content {\r\n        margin-top: 10px;\r\n        font-size: 20px;\r\n        color: #333;\r\n      }\r\n\r\n      .comment-images {\r\n        margin-top: 10px;\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n        justify-content: center;\r\n\r\n        img {\r\n          margin: 5px;\r\n          border-radius: 5px;\r\n          box-shadow: 0 0 5px #ccc;\r\n        }\r\n      }\r\n\r\n      .comment-time {\r\n        margin-top: 10px;\r\n        font-size: 14px;\r\n        color: #999;\r\n      }\r\n\r\n    }\r\n\r\n    .comment-store {\r\n      margin-top: 10px;\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      .store-avatar {\r\n        margin-right: 10px;\r\n      }\r\n\r\n      .store-name {\r\n        font-size: 16px;\r\n        color: #333;\r\n\r\n        &:hover {\r\n          color: #e02020;\r\n          cursor: pointer;\r\n        }\r\n      }\r\n    }\r\n\r\n    .comment-product {\r\n      margin-top: 10px;\r\n      display: block;\r\n      align-items: center;\r\n\r\n      .product-name {\r\n        font-size: 16px;\r\n        color: #333;\r\n\r\n        &:hover {\r\n          color: #e02020;\r\n        }\r\n      }\r\n\r\n      .product-price {\r\n        margin-left: 10px;\r\n        font-size: 16px;\r\n        color: #e02020;\r\n      }\r\n    }\r\n\r\n    .comment-work {\r\n      margin-top: 10px;\r\n      display: flex;\r\n      justify-content: center;\r\n\r\n      .el-button {\r\n        margin-left: 10px;\r\n        font-size: 18px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}