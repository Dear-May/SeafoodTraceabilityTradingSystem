{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createBlock as _createBlock } from \"vue\";\nimport _imports_0 from '../images/logo.png';\nconst _hoisted_1 = {\n  class: \"login-section\",\n  style: {\n    \"display\": \"flex\",\n    \"width\": \"100%\",\n    \"align-items\": \"center\"\n  }\n};\nconst _hoisted_2 = {\n  class: \"qr-login-section\",\n  style: {\n    \"margin-top\": \"50px\",\n    \"border-right\": \"1px solid #ddd\",\n    \"padding-right\": \"40px\"\n  }\n};\nconst _hoisted_3 = {\n  class: \"qr-login\"\n};\nconst _hoisted_4 = {\n  class: \"credentials-login-section\"\n};\nconst _hoisted_5 = {\n  class: \"login-methods tab-buttons\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"password-login\"\n};\nconst _hoisted_7 = {\n  class: \"password-input-container\"\n};\nconst _hoisted_8 = {\n  key: 1,\n  class: \"sms-login\"\n};\nconst _hoisted_9 = {\n  class: \"third-party-login\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_header = _resolveComponent(\"el-header\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_link = _resolveComponent(\"el-link\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_el_col = _resolveComponent(\"el-col\");\n  const _component_el_row = _resolveComponent(\"el-row\");\n  const _component_el_main = _resolveComponent(\"el-main\");\n  const _component_el_switch = _resolveComponent(\"el-switch\");\n  const _component_el_aside = _resolveComponent(\"el-aside\");\n  const _component_el_container = _resolveComponent(\"el-container\");\n  return _openBlock(), _createBlock(_component_el_container, {\n    class: _normalizeClass([\"login-container\", {\n      'night-mode': $setup.isNightMode\n    }])\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_header, {\n      class: \"login-logo header-left\"\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"img\", {\n        src: _imports_0,\n        alt: \"Logo\",\n        class: \"logo-img\",\n        onClick: $setup.handleHome\n      }), _cache[7] || (_cache[7] = _createElementVNode(\"span\", {\n        class: \"header-title\"\n      }, \"海潮    海鲜食品溯源交易平台\", -1 /* HOISTED */))]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_main, {\n      class: \"login-content\"\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[9] || (_cache[9] = _createElementVNode(\"p\", {\n        class: \"qr-login-text\",\n        style: {\n          \"margin-bottom\": \"20px\",\n          \"margin-top\": \"0\",\n          \"align-self\": \"center\",\n          \"font-size\": \"24px\"\n        }\n      }, \" 手机扫码登录\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_3, [_createVNode($setup[\"wxLogin\"]), _cache[8] || (_cache[8] = _createElementVNode(\"p\", {\n        class: \"qr-login-text\"\n      }, \"打开微信APP，点击左上角扫一扫\", -1 /* HOISTED */))])]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_el_button, {\n        class: _normalizeClass([{\n          'active-tab': $setup.activeTab === 'password'\n        }, \"login-method-button\"]),\n        onClick: _cache[0] || (_cache[0] = $event => $setup.activeTab = 'password')\n      }, {\n        default: _withCtx(() => _cache[10] || (_cache[10] = [_createElementVNode(\"p\", {\n          style: {\n            \"font-size\": \"24px\"\n          }\n        }, \"密码登录\", -1 /* HOISTED */)])),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"class\"]), _cache[12] || (_cache[12] = _createElementVNode(\"span\", {\n        class: \"separator\"\n      }, \"|\", -1 /* HOISTED */)), _createVNode(_component_el_button, {\n        class: _normalizeClass([{\n          'active-tab': $setup.activeTab === 'sms'\n        }, \"login-method-button\"]),\n        onClick: _cache[1] || (_cache[1] = $event => $setup.activeTab = 'sms')\n      }, {\n        default: _withCtx(() => _cache[11] || (_cache[11] = [_createElementVNode(\"p\", {\n          style: {\n            \"font-size\": \"24px\"\n          }\n        }, \"短信登录\", -1 /* HOISTED */)])),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"class\"])]), $setup.activeTab === 'password' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createVNode(_component_el_form, {\n        model: $setup.loginForm,\n        \"status-icon\": \"\",\n        ref: \"loginFormRef\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $setup.loginForm.username,\n          \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.loginForm.username = $event),\n          placeholder: \"账号名/邮箱/手机号\",\n          class: \"custom-input\"\n        }, null, 8 /* PROPS */, [\"modelValue\"]), _createElementVNode(\"div\", _hoisted_7, [_createVNode(_component_el_input, {\n          modelValue: $setup.loginForm.password,\n          \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.loginForm.password = $event),\n          type: \"password\",\n          placeholder: \"请输入登录密码\",\n          class: \"custom-input password-input\"\n        }, {\n          append: _withCtx(() => [_createVNode(_component_el_link, {\n            type: \"info\",\n            class: \"forgot-password-link no-unecoration\",\n            onClick: $setup.handleForgotPassword\n          }, {\n            default: _withCtx(() => _cache[13] || (_cache[13] = [_createTextVNode(\" 忘记密码 \")])),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"modelValue\"])]), _createVNode(_component_el_form_item, null, {\n          default: _withCtx(() => [_createVNode(_component_el_button, {\n            type: \"primary\",\n            onClick: $setup.handleLogin,\n            block: \"\",\n            class: \"login-button\"\n          }, {\n            default: _withCtx(() => _cache[14] || (_cache[14] = [_createTextVNode(\"登录\")])),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"model\"])])) : _createCommentVNode(\"v-if\", true), $setup.activeTab === 'sms' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [_createVNode(_component_el_form, {\n        model: $setup.smsForm,\n        \"status-icon\": \"\",\n        ref: \"smsFormRef\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $setup.smsForm.phone,\n          \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.smsForm.phone = $event),\n          id: \"phone\",\n          placeholder: \"手机号\",\n          class: \"custom-input\"\n        }, null, 8 /* PROPS */, [\"modelValue\"]), _createVNode(_component_el_row, {\n          gutter: 10\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_col, {\n            span: 14\n          }, {\n            default: _withCtx(() => [_createVNode(_component_el_input, {\n              modelValue: $setup.smsForm.code,\n              \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $setup.smsForm.code = $event),\n              placeholder: \"验证码\",\n              class: \"custom-input\"\n            }, null, 8 /* PROPS */, [\"modelValue\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_col, {\n            span: 10\n          }, {\n            default: _withCtx(() => [_createVNode(_component_el_button, {\n              id: \"captcha-button\",\n              type: \"primary\",\n              disabled: $setup.isButtonDisabled,\n              onClick: $setup.CheckPhoneNumber,\n              class: \"sms-code-button\"\n            }, {\n              default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.buttonText), 1 /* TEXT */)]),\n              _: 1 /* STABLE */\n            }, 8 /* PROPS */, [\"disabled\"])]),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }), _createVNode($setup[\"Vcode\"], {\n          show: $setup.isShow,\n          onSuccess: $setup.onSuccess,\n          onClose: $setup.onClose\n        }, null, 8 /* PROPS */, [\"show\"]), _createVNode(_component_el_form_item, null, {\n          default: _withCtx(() => [_createVNode(_component_el_button, {\n            type: \"primary\",\n            onClick: $setup.validateNum,\n            block: \"\",\n            class: \"login-button\"\n          }, {\n            default: _withCtx(() => _cache[15] || (_cache[15] = [_createTextVNode(\"登录\")])),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"model\"])])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_9, [_cache[17] || (_cache[17] = _createElementVNode(\"span\", null, \"第三方登录：\", -1 /* HOISTED */)), _createVNode($setup[\"GiteeLogin\"]), _createVNode($setup[\"GitHubLogin\"]), _createVNode($setup[\"GoogleLogin\"]), _cache[18] || (_cache[18] = _createElementVNode(\"span\", {\n        class: \"separator\"\n      }, \"|\", -1 /* HOISTED */)), _createVNode(_component_el_button, {\n        type: \"text\",\n        class: \"register-button\",\n        onClick: $setup.handleRegister\n      }, {\n        default: _withCtx(() => _cache[16] || (_cache[16] = [_createTextVNode(\"注册账号\")])),\n        _: 1 /* STABLE */\n      })])])])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_aside, {\n      class: \"night-mode-toggle\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_switch, {\n        modelValue: $setup.themeStore.isNightMode,\n        \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => $setup.themeStore.isNightMode = $event),\n        \"active-text\": \"夜间模式\",\n        \"inactive-text\": \"白天模式\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode($setup[\"FooterLoginComponent\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"class\"]);\n}","map":{"version":3,"names":["_imports_0","class","style","key","_createBlock","_component_el_container","_normalizeClass","$setup","isNightMode","default","_withCtx","_createVNode","_component_el_header","_createElementVNode","src","alt","onClick","handleHome","_","_component_el_main","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_component_el_button","activeTab","_cache","$event","_createElementBlock","_hoisted_6","_component_el_form","model","loginForm","ref","_component_el_input","modelValue","username","placeholder","_hoisted_7","password","type","append","_component_el_link","handleForgotPassword","_createTextVNode","_component_el_form_item","handleLogin","block","_createCommentVNode","_hoisted_8","smsForm","phone","id","_component_el_row","gutter","_component_el_col","span","code","disabled","isButtonDisabled","CheckPhoneNumber","_toDisplayString","buttonText","show","isShow","onSuccess","onClose","validateNum","_hoisted_9","handleRegister","_component_el_aside","_component_el_switch","themeStore"],"sources":["D:\\Cache\\Java\\shopping\\shoppping_c_frontend\\src\\views\\LoginView.vue"],"sourcesContent":["<template xmlns=\"http://www.w3.org/1999/xhtml\">\r\n  <el-container class=\"login-container\" :class=\"{ 'night-mode': isNightMode }\">\r\n    <el-header class=\"login-logo header-left\">\r\n      <img src=\"../images/logo.png\" alt=\"Logo\" class=\"logo-img\" @click=\"handleHome\"/>\r\n      <span class=\"header-title\">海潮&nbsp;&nbsp;&nbsp;&nbsp;海鲜食品溯源交易平台</span>\r\n    </el-header>\r\n    <el-main class=\"login-content\">\r\n      <div class=\"login-section\" style=\"display: flex; width: 100%; align-items: center;\">\r\n        <div class=\"qr-login-section\" style=\"margin-top: 50px; border-right: 1px solid #ddd; padding-right: 40px;\">\r\n          <p class=\"qr-login-text\" style=\"margin-bottom: 20px; margin-top: 0; align-self: center; font-size: 24px;\">\r\n            手机扫码登录</p>\r\n          <div class=\"qr-login\">\r\n            <wxLogin/>\r\n            <p class=\"qr-login-text\">打开微信APP，点击左上角扫一扫</p>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"credentials-login-section\">\r\n          <div class=\"login-methods tab-buttons\">\r\n            <el-button :class=\"{'active-tab': activeTab === 'password'}\" @click=\"activeTab = 'password'\"\r\n                       class=\"login-method-button\"><p style=\"font-size:24px\">密码登录</p>\r\n            </el-button>\r\n            <span class=\"separator\">|</span>\r\n            <el-button :class=\"{'active-tab': activeTab === 'sms'}\" @click=\"activeTab = 'sms'\"\r\n                       class=\"login-method-button\"><p style=\"font-size:24px\">短信登录</p>\r\n            </el-button>\r\n\r\n          </div>\r\n          <div v-if=\"activeTab === 'password'\" class=\"password-login\">\r\n            <el-form :model=\"loginForm\" status-icon ref=\"loginFormRef\">\r\n              <el-input v-model=\"loginForm.username\" placeholder=\"账号名/邮箱/手机号\" class=\"custom-input\"></el-input>\r\n              <div class=\"password-input-container\">\r\n                <el-input v-model=\"loginForm.password\" type=\"password\" placeholder=\"请输入登录密码\"\r\n                          class=\"custom-input password-input\">\r\n                  <template #append>\r\n                    <el-link type=\"info\" class=\"forgot-password-link no-unecoration\" @click=\"handleForgotPassword\">\r\n                      忘记密码\r\n                    </el-link>\r\n                  </template>\r\n                </el-input>\r\n              </div>\r\n              <el-form-item>\r\n                <el-button type=\"primary\" @click=\"handleLogin\" block class=\"login-button\">登录</el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n          <div v-if=\"activeTab === 'sms'\" class=\"sms-login\">\r\n            <el-form :model=\"smsForm\" status-icon ref=\"smsFormRef\">\r\n              <el-input v-model=\"smsForm.phone\" id=\"phone\" placeholder=\"手机号\" class=\"custom-input\"></el-input>\r\n              <el-row :gutter=\"10\">\r\n                <el-col :span=\"14\">\r\n                  <el-input v-model=\"smsForm.code\" placeholder=\"验证码\" class=\"custom-input\"></el-input>\r\n                </el-col>\r\n                <el-col :span=\"10\">\r\n                  <el-button\r\n                      id=\"captcha-button\"\r\n                      type=\"primary\"\r\n                      :disabled=\"isButtonDisabled\"\r\n                      @click=\"CheckPhoneNumber\"\r\n                      class=\"sms-code-button\">\r\n                    {{ buttonText }}\r\n                  </el-button>\r\n                </el-col>\r\n              </el-row>\r\n              <Vcode :show=\"isShow\" @success=\"onSuccess\" @close=\"onClose\"/>\r\n              <el-form-item>\r\n                <el-button type=\"primary\" @click=\"validateNum\" block class=\"login-button\">登录</el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n          <div class=\"third-party-login\">\r\n            <span>第三方登录：</span>\r\n            <GiteeLogin/>\r\n            <GitHubLogin/>\r\n            <GoogleLogin/>\r\n            <span class=\"separator\">|</span>\r\n            <el-button type=\"text\" class=\"register-button\" @click=\"handleRegister\">注册账号</el-button>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </el-main>\r\n    <el-aside class=\"night-mode-toggle\">\r\n      <el-switch v-model=\"themeStore.isNightMode\" active-text=\"夜间模式\" inactive-text=\"白天模式\"></el-switch>\r\n    </el-aside>\r\n    <FooterLoginComponent/>\r\n  </el-container>\r\n</template>\r\n\r\n<script setup>\r\nimport {computed, ref, watch} from 'vue';\r\nimport {useRouter} from 'vue-router';\r\nimport axios from 'axios';\r\nimport {ElMessage} from 'element-plus';\r\nimport Vcode from \"vue3-puzzle-vcode\";\r\nimport {useThemeStore} from '@/store/themeStore';\r\nimport GiteeLogin from \"@/components/GiteeLoginComponent.vue\";\r\nimport GitHubLogin from \"@/components/GitHubLoginComponent.vue\";\r\nimport wxLogin from \"@/components/WechatLoginComponent.vue\"\r\nimport GoogleLogin from \"@/components/GoogleLoginComponent.vue\";\r\nimport FooterLoginComponent from \"@/components/FooterLoginComponent.vue\";\r\n\r\n\r\nconst router = useRouter();\r\nconst activeTab = ref('password');\r\nconst loginForm = ref({\r\n  username: '',\r\n  password: ''\r\n});\r\nconst smsForm = ref({\r\n  phone: '',\r\n  code: ''\r\n});\r\nconst loginFormRef = ref(null);\r\nconst smsFormRef = ref(null);\r\nconst themeStore = useThemeStore();\r\nconst isNightMode = computed(() => themeStore.isNightMode);\r\nconst rememberMe = ref(false);\r\nwatch(isNightMode, (newVal) => {\r\n  if (newVal) {\r\n    document.body.classList.add('night-mode');\r\n  } else {\r\n    document.body.classList.remove('night-mode');\r\n  }\r\n});\r\n\r\n// 检测是否存在cookie，如果存在，则填入session\r\ntry {\r\n  const userBaseInfo = JSON.parse(decodeURIComponent(document.cookie.replace(/(?:^|.*;\\s*)userBaseInfo\\s*=\\s*([^;]*).*$|^.*$/, \"$1\")));\r\n  if (userBaseInfo) {\r\n    try {\r\n      sessionStorage.setItem('userBaseInfo', JSON.stringify(userBaseInfo));\r\n    } catch (error) {\r\n      console.log(\"无cookie\")\r\n    }\r\n  }\r\n} catch (error) {\r\n  console.log(\"无cookie\");\r\n}\r\n// 检测是否存在session，如果存在，则跳转到首页\r\nconst userBaseInfoFromSession = JSON.parse(sessionStorage.getItem('userBaseInfo'));\r\nif (userBaseInfoFromSession) {\r\n  router.replace('/');\r\n}\r\n\r\nasync function getUserBaseInfo(username) {\r\n  try {\r\n    const response = await axios.post('/api/user/getUserBaseInfo', {\r\n      username: username\r\n    }, {\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      withCredentials: true\r\n    });\r\n    if (response.data.id !== null) {\r\n      console.log(response.data);\r\n      sessionStorage.setItem('userBaseInfo', JSON.stringify(response.data)); // 存储用户信息到sessionStorage\r\n      document.cookie = `userBaseInfo=${encodeURIComponent(JSON.stringify(response.data))}; path=/; max-age=604800`; // 存储用户信息到cookie，有效期7天\r\n    }\r\n  } catch (err) {\r\n    ElMessage.error('获取用户信息失败，请稍后再试！');\r\n  }\r\n}\r\n\r\nasync function handleLogin() {\r\n  try {\r\n    await loginFormRef.value.validate();\r\n    const response = await axios.post('/api/user/login', {\r\n      username: loginForm.value.username,\r\n      password: loginForm.value.password,\r\n      rememberMe: rememberMe.value\r\n    }, {\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      withCredentials: true\r\n    });\r\n    if (response.data.code === 200) {\r\n      ElMessage.success('登录成功！');\r\n      await getUserBaseInfo(loginForm.value.username);\r\n      setTimeout(() => {\r\n        router.replace('/index');\r\n      }, 1500);\r\n    } else if (response.data.code === 400) {\r\n      ElMessage.error('用户名或密码错误！请重新登录！');\r\n      loginForm.value.username = '';\r\n      loginForm.value.password = '';\r\n    } else if (response.data.code === 401) {\r\n      ElMessage.error('用户名不存在！请重新登录！');\r\n      loginForm.value.username = '';\r\n      loginForm.value.password = '';\r\n    }\r\n  } catch (error) {\r\n    console.error('Error during login:', error.message);\r\n  }\r\n}\r\n\r\n// 验证码部分\r\nconst wait = ref(60);\r\nconst isButtonDisabled = ref(false);\r\nconst buttonText = ref('获取验证码');\r\nconst isShow = ref(false);\r\n\r\nwatch(wait, (newValue) => {\r\n  if (newValue === 0) {\r\n    isButtonDisabled.value = false;\r\n    buttonText.value = '获取验证码';\r\n    wait.value = 60; // 重置计时器\r\n  } else {\r\n    buttonText.value = `${newValue}秒后可以重新发送`;\r\n  }\r\n});\r\n\r\nasync function CheckPhoneNumber() {\r\n  if (smsForm.value.phone.length === 0) {\r\n    ElMessage.error('请输入手机号码！');\r\n    return;\r\n  } else if (!/^1[3-9]\\d{9}$/.test(smsForm.value.phone)) {\r\n    ElMessage.error('请输入正确的手机号码！');\r\n    return;\r\n  }\r\n  onShow();\r\n}\r\n\r\n// 人机验证部分\r\nconst onShow = () => {\r\n  isShow.value = true;\r\n};\r\n\r\nconst onClose = () => {\r\n  isShow.value = false;\r\n};\r\n\r\nconst onSuccess = () => {\r\n  onClose(); // 验证成功，需要手动关闭模态框\r\n  getMsgNum(); // 获取验证码\r\n};\r\n\r\n// 获取验证码\r\nasync function getMsgNum() {\r\n  setButtonStatus(); // 设置按钮状态\r\n  try {\r\n    const response = await axios.post('/api/sms/smsXxs', {\r\n      phoneNumber: smsForm.value.phone,\r\n    }, {\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      withCredentials: true\r\n    });\r\n\r\n    if (response.data.isOk === \"OK\") {\r\n      ElMessage.success('验证码已发送到您的手机，请注意查收！');\r\n    } else {\r\n      ElMessage.error('验证码发送失败，请稍后再试！');\r\n    }\r\n  } catch (error) {\r\n    console.error(\"发送验证码错误:\", error);\r\n  }\r\n}\r\n\r\n// 设置按钮状态\r\nfunction setButtonStatus() {\r\n  isButtonDisabled.value = true;\r\n  wait.value = wait.value > 0 ? wait.value : 60; // 确保初始值有效\r\n  countdown();\r\n}\r\n\r\n// 计时功能\r\nfunction countdown() {\r\n  if (wait.value > 0) {\r\n    setTimeout(() => {\r\n      wait.value -= 1;\r\n      countdown();\r\n    }, 1000);\r\n  }\r\n}\r\n\r\n// 登录按钮\r\nasync function validateNum() {\r\n  if (smsForm.value.phone.length === 0 || smsForm.value.phone.length === 0) {\r\n    ElMessage.error('请输入手机号码和验证码！');\r\n    return;\r\n  }\r\n  const data = {\r\n    verifyCode: smsForm.value.code,\r\n    phone: smsForm.value.phone,\r\n  };\r\n\r\n  try {\r\n    await smsFormRef.value.validate();\r\n    const response = await axios.post('/api/sms/validateNum', data, {\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      withCredentials: true\r\n    });\r\n    if (response.data.result === 404) {\r\n      ElMessage.error('过期验证码已失效!');\r\n    } else if (response.data.result === 500) {\r\n      ElMessage.error('验证码错误，请重新输入！');\r\n    } else if (response.data.result === 403) {\r\n      ElMessage.error('用户不存在，请注册账号！');\r\n    } else {\r\n      ElMessage.success('登录成功！');\r\n      await getUserBaseInfo(smsForm.value.phone);\r\n      setTimeout(() => {\r\n        router.replace('/index');\r\n      }, 1500);\r\n    }\r\n  } catch (error) {\r\n    console.error(\"验证错误:\", error);\r\n  }\r\n}\r\n\r\nfunction handleHome() {\r\n  router.push('/index');\r\n}\r\n\r\nfunction handleForgotPassword() {\r\n  router.push('/forgotPassword');\r\n}\r\n\r\nfunction handleRegister() {\r\n  router.push('/register');\r\n}\r\n\r\n\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.login-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 40px;\r\n  background-color: #f7f7f7;\r\n  min-height: 100vh;\r\n  justify-content: space-between;\r\n}\r\n\r\n.login-logo {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 50px;\r\n  position: absolute;\r\n  top: 20px;\r\n  left: 20px;\r\n}\r\n\r\n.logo-img {\r\n  width: 120px;\r\n}\r\n\r\n.login-logo img {\r\n  width: 150px;\r\n}\r\n\r\n.header-title {\r\n  margin-left: 15px;\r\n  font-size: 28px;\r\n  color: #668B8B;\r\n  font-weight: bold;\r\n  line-height: 1;\r\n}\r\n\r\n\r\n.login-content {\r\n  max-height: 65vh;\r\n  display: flex;\r\n  width: 100%;\r\n  max-width: 900px;\r\n  padding: 20px;\r\n  background-color: #fff;\r\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\r\n  border-radius: 12px;\r\n  position: relative;\r\n  top: 20vh;\r\n}\r\n\r\n.login-section {\r\n  display: flex;\r\n  width: 100%;\r\n}\r\n\r\n.qr-login-section {\r\n  flex: 0.33;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  padding-right: 50px;\r\n  margin-left: 50px;\r\n  border-right: 1px solid #ddd;\r\n  margin-top: 40px;\r\n}\r\n\r\n.credentials-login-section {\r\n  flex: 0.66;\r\n  padding-left: 30px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: flex-start;\r\n  margin-top: 0;\r\n}\r\n\r\n.login-method-button {\r\n  color: #668B8B;\r\n  font-size: 20px;\r\n  padding: 10px;\r\n}\r\n\r\n.login-method-button {\r\n  font-size: 16px;\r\n  padding: 10px 20px;\r\n  border: none;\r\n  background-color: transparent;\r\n  color: #666;\r\n  cursor: pointer;\r\n}\r\n\r\n.active-tab {\r\n  font-weight: bold;\r\n  color: #668B8B;\r\n  border-bottom: 2px solid #668B8B;\r\n}\r\n\r\n.separator {\r\n  font-size: 20px;\r\n  color: #ccc;\r\n  margin: 0 20px;\r\n  align-self: center;\r\n}\r\n\r\n.qr-login {\r\n  text-align: center;\r\n}\r\n\r\n.qr-code {\r\n  width: 180px;\r\n  height: 180px;\r\n  margin-bottom: 10px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 8px;\r\n}\r\n\r\n.qr-login-text {\r\n  font-size: 14px;\r\n  color: #666;\r\n}\r\n\r\n.password-login,\r\n.sms-login {\r\n  padding: 20px;\r\n}\r\n\r\n.custom-input {\r\n  border-radius: 10px;\r\n  padding: 16px;\r\n  font-size: 18px;\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.password-input {\r\n  border-right: none;\r\n}\r\n\r\n.forgot-password-link {\r\n  color: #666;\r\n  font-size: 16px;\r\n  cursor: pointer;\r\n  border-left: none;\r\n  padding-left: 8px;\r\n  border-right: none;\r\n}\r\n\r\n.no-underline {\r\n  text-decoration: none;\r\n}\r\n\r\n.forgot-password-input {\r\n  text-align: right;\r\n  cursor: pointer;\r\n  color: #666;\r\n  font-size: 16px;\r\n}\r\n\r\n.third-party-login {\r\n  text-align: center;\r\n  margin-top: 20px;\r\n  font-size: 16px;\r\n  color: #666;\r\n}\r\n\r\n.third-party-login .el-button {\r\n  margin: 0 10px;\r\n  font-size: 20px;\r\n}\r\n\r\n.night-mode-toggle {\r\n  position: fixed;\r\n  top: 20px;\r\n  right: 20px;\r\n}\r\n\r\n.login-button {\r\n  font-size: 18px;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  width: 100%;\r\n}\r\n\r\n.sms-code-button {\r\n  margin-top: 15px;\r\n  height: 30px; /* 与输入框高度保持一致 */\r\n  padding: 0 20px; /* 左右内边距让按钮显得更舒展 */\r\n  font-size: 16px;\r\n  border-radius: 8px;\r\n  line-height: 48px; /* 与按钮高度一致，保证文字垂直居中 */\r\n  //居中显示\r\n  display: flex;\r\n\r\n}\r\n\r\n.el-button--primary {\r\n  background-color: #668B8B;\r\n  border-color: #668B8B;\r\n}\r\n\r\n.el-button--primary:hover {\r\n  background-color: #96CDCD;\r\n  border-color: #96CDCD;\r\n}\r\n\r\nbody.night-mode, html.night-mode {\r\n  background-color: #1f1f1f;\r\n  color: #f7f7f7;\r\n}\r\n\r\n.night-mode .el-container {\r\n  background-color: #1f1f1f; /* 设置容器的深色背景 */\r\n}\r\n\r\n.el-footer.night-mode {\r\n  color: #96CDCD;\r\n}\r\n\r\n.el-footer.night-mode.a {\r\n  color: #96CDCD;\r\n}\r\n\r\nbody.night-mode .login-content {\r\n  background-color: #333;\r\n  color: #f7f7f7;\r\n}\r\n\r\nbody.night-mode .el-input,\r\nbody.night-mode .el-input__inner {\r\n  background-color: #444;\r\n  color: #f7f7f7;\r\n  border-color: #555;\r\n}\r\n\r\nbody.night-mode .el-button--primary {\r\n  background-color: #96CDCD;\r\n  border-color: #96CDCD;\r\n}\r\n\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}