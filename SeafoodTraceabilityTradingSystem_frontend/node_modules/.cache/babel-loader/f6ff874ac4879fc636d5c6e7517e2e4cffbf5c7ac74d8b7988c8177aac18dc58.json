{"ast":null,"code":"import { ref } from 'vue';\nimport { useRouter } from 'vue-router';\nimport axios from 'axios';\nimport { ElMessage } from 'element-plus';\nexport function useUserShop() {\n  const UserForm = ref({\n    id: null,\n    phone: null,\n    shopid: null,\n    nickname: null,\n    role: null,\n    avatar: null,\n    email: null,\n    status: null\n  });\n  const shopForm = ref({\n    status: null,\n    shopID: null,\n    shopDesc: null,\n    shopName: null,\n    shopAvatar: null\n  });\n  const router = useRouter();\n  const initUserSession = () => {\n    try {\n      const ShopUserBaseInfo = JSON.parse(decodeURIComponent(document.cookie.replace(/(?:^|.*;\\s*)ShopUserBaseInfo\\s*=\\s*([^;]*).*$|^.*$/, \"$1\")));\n      if (ShopUserBaseInfo) {\n        sessionStorage.setItem('ShopUserBaseInfoSession', JSON.stringify(ShopUserBaseInfo));\n      }\n    } catch (error) {\n      console.log(\"无cookie\");\n    }\n    const ShopUserBaseInfoFromSession = JSON.parse(sessionStorage.getItem('ShopUserBaseInfoSession'));\n    if (ShopUserBaseInfoFromSession) {\n      UserForm.value = ShopUserBaseInfoFromSession;\n      if (window.location.pathname === '/store/login') {\n        router.replace('/store/index');\n      }\n    } else {\n      router.replace('/store/login');\n    }\n  };\n  const initShopInfo = async () => {\n    try {\n      const response = await axios.post('/api/shop/findShopById', {\n        shopId: UserForm.value.shopid\n      }, {\n        headers: {\n          'Content-Type': 'application/json;charset=UTF-8'\n        },\n        withCredentials: true\n      });\n      if (response.data !== null) {\n        shopForm.value = response.data;\n      } else {\n        ElMessage.error('获取店铺信息失败，请稍后再试');\n      }\n    } catch (err) {\n      ElMessage.error('获取店铺信息失败，请稍后再试');\n    }\n  };\n  return {\n    UserForm,\n    shopForm,\n    initUserSession,\n    initShopInfo\n  };\n}","map":{"version":3,"names":["ref","useRouter","axios","ElMessage","useUserShop","UserForm","id","phone","shopid","nickname","role","avatar","email","status","shopForm","shopID","shopDesc","shopName","shopAvatar","router","initUserSession","ShopUserBaseInfo","JSON","parse","decodeURIComponent","document","cookie","replace","sessionStorage","setItem","stringify","error","console","log","ShopUserBaseInfoFromSession","getItem","value","window","location","pathname","initShopInfo","response","post","shopId","headers","withCredentials","data","err"],"sources":["D:/Cache/Java/shopping/shoppping_c_frontend/src/composables/useShopUser.js"],"sourcesContent":["import {ref} from 'vue';\r\nimport {useRouter} from 'vue-router';\r\nimport axios from 'axios';\r\nimport {ElMessage} from 'element-plus';\r\n\r\nexport function useUserShop() {\r\n    const UserForm = ref({\r\n        id: null,\r\n        phone: null,\r\n        shopid: null,\r\n        nickname: null,\r\n        role: null,\r\n        avatar: null,\r\n        email: null,\r\n        status: null,\r\n    });\r\n\r\n    const shopForm = ref({\r\n        status: null,\r\n        shopID: null,\r\n        shopDesc: null,\r\n        shopName: null,\r\n        shopAvatar: null,\r\n    });\r\n\r\n    const router = useRouter();\r\n\r\n    const initUserSession = () => {\r\n        try {\r\n            const ShopUserBaseInfo = JSON.parse(decodeURIComponent(document.cookie.replace(/(?:^|.*;\\s*)ShopUserBaseInfo\\s*=\\s*([^;]*).*$|^.*$/, \"$1\")));\r\n            if (ShopUserBaseInfo) {\r\n                sessionStorage.setItem('ShopUserBaseInfoSession', JSON.stringify(ShopUserBaseInfo));\r\n            }\r\n        } catch (error) {\r\n            console.log(\"无cookie\");\r\n        }\r\n\r\n        const ShopUserBaseInfoFromSession = JSON.parse(sessionStorage.getItem('ShopUserBaseInfoSession'));\r\n        if (ShopUserBaseInfoFromSession) {\r\n            UserForm.value = ShopUserBaseInfoFromSession;\r\n            if (window.location.pathname === '/store/login') {\r\n                router.replace('/store/index');\r\n            }\r\n        } else {\r\n            router.replace('/store/login');\r\n        }\r\n    };\r\n\r\n    const initShopInfo = async () => {\r\n        try {\r\n            const response = await axios.post('/api/shop/findShopById', {\r\n                shopId: UserForm.value.shopid,\r\n            }, {\r\n                headers: {\r\n                    'Content-Type': 'application/json;charset=UTF-8'\r\n                },\r\n                withCredentials: true,\r\n            });\r\n            if (response.data !== null) {\r\n                shopForm.value = response.data;\r\n            } else {\r\n                ElMessage.error('获取店铺信息失败，请稍后再试');\r\n            }\r\n        } catch (err) {\r\n            ElMessage.error('获取店铺信息失败，请稍后再试');\r\n        }\r\n    };\r\n\r\n    return {\r\n        UserForm,\r\n        shopForm,\r\n        initUserSession,\r\n        initShopInfo,\r\n    };\r\n}\r\n"],"mappings":"AAAA,SAAQA,GAAG,QAAO,KAAK;AACvB,SAAQC,SAAS,QAAO,YAAY;AACpC,OAAOC,KAAK,MAAM,OAAO;AACzB,SAAQC,SAAS,QAAO,cAAc;AAEtC,OAAO,SAASC,WAAWA,CAAA,EAAG;EAC1B,MAAMC,QAAQ,GAAGL,GAAG,CAAC;IACjBM,EAAE,EAAE,IAAI;IACRC,KAAK,EAAE,IAAI;IACXC,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE,IAAI;IACdC,IAAI,EAAE,IAAI;IACVC,MAAM,EAAE,IAAI;IACZC,KAAK,EAAE,IAAI;IACXC,MAAM,EAAE;EACZ,CAAC,CAAC;EAEF,MAAMC,QAAQ,GAAGd,GAAG,CAAC;IACjBa,MAAM,EAAE,IAAI;IACZE,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE,IAAI;IACdC,QAAQ,EAAE,IAAI;IACdC,UAAU,EAAE;EAChB,CAAC,CAAC;EAEF,MAAMC,MAAM,GAAGlB,SAAS,CAAC,CAAC;EAE1B,MAAMmB,eAAe,GAAGA,CAAA,KAAM;IAC1B,IAAI;MACA,MAAMC,gBAAgB,GAAGC,IAAI,CAACC,KAAK,CAACC,kBAAkB,CAACC,QAAQ,CAACC,MAAM,CAACC,OAAO,CAAC,oDAAoD,EAAE,IAAI,CAAC,CAAC,CAAC;MAC5I,IAAIN,gBAAgB,EAAE;QAClBO,cAAc,CAACC,OAAO,CAAC,yBAAyB,EAAEP,IAAI,CAACQ,SAAS,CAACT,gBAAgB,CAAC,CAAC;MACvF;IACJ,CAAC,CAAC,OAAOU,KAAK,EAAE;MACZC,OAAO,CAACC,GAAG,CAAC,SAAS,CAAC;IAC1B;IAEA,MAAMC,2BAA2B,GAAGZ,IAAI,CAACC,KAAK,CAACK,cAAc,CAACO,OAAO,CAAC,yBAAyB,CAAC,CAAC;IACjG,IAAID,2BAA2B,EAAE;MAC7B7B,QAAQ,CAAC+B,KAAK,GAAGF,2BAA2B;MAC5C,IAAIG,MAAM,CAACC,QAAQ,CAACC,QAAQ,KAAK,cAAc,EAAE;QAC7CpB,MAAM,CAACQ,OAAO,CAAC,cAAc,CAAC;MAClC;IACJ,CAAC,MAAM;MACHR,MAAM,CAACQ,OAAO,CAAC,cAAc,CAAC;IAClC;EACJ,CAAC;EAED,MAAMa,YAAY,GAAG,MAAAA,CAAA,KAAY;IAC7B,IAAI;MACA,MAAMC,QAAQ,GAAG,MAAMvC,KAAK,CAACwC,IAAI,CAAC,wBAAwB,EAAE;QACxDC,MAAM,EAAEtC,QAAQ,CAAC+B,KAAK,CAAC5B;MAC3B,CAAC,EAAE;QACCoC,OAAO,EAAE;UACL,cAAc,EAAE;QACpB,CAAC;QACDC,eAAe,EAAE;MACrB,CAAC,CAAC;MACF,IAAIJ,QAAQ,CAACK,IAAI,KAAK,IAAI,EAAE;QACxBhC,QAAQ,CAACsB,KAAK,GAAGK,QAAQ,CAACK,IAAI;MAClC,CAAC,MAAM;QACH3C,SAAS,CAAC4B,KAAK,CAAC,gBAAgB,CAAC;MACrC;IACJ,CAAC,CAAC,OAAOgB,GAAG,EAAE;MACV5C,SAAS,CAAC4B,KAAK,CAAC,gBAAgB,CAAC;IACrC;EACJ,CAAC;EAED,OAAO;IACH1B,QAAQ;IACRS,QAAQ;IACRM,eAAe;IACfoB;EACJ,CAAC;AACL","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}