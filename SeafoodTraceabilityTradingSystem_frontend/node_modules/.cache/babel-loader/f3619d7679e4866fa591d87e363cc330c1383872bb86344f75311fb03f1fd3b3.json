{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport HeaderComponent from \"@/components/HeaderComponent.vue\";\nimport router from \"@/router\";\nimport FooterComponent from \"@/components/FooterComponent.vue\";\nimport RightWidgetComponent from \"@/components/RightWidgetComponent.vue\";\nimport { onMounted, ref } from 'vue';\nimport { ElMessage } from \"element-plus\";\nimport axios from 'axios';\nimport SidebarComponent from \"@/components/SidebarComponent.vue\";\nimport useUser from \"@/composables/useUser\";\nexport default {\n  __name: 'MyFavoriteView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const {\n      UserInfoForm,\n      initUserSession\n    } = useUser();\n    const sidebarComponent = ref(null);\n    function initSidebar() {\n      sidebarComponent.value.setActive(7);\n    }\n    function handleProductDetail(product) {\n      router.push('/goodDetail?id=' + product.goodID);\n    }\n    const historicalData = ref([]);\n    const searchQuery = ref('');\n    const filteredHistoricalData = ref([]);\n    function filterProducts() {\n      // 检查搜索查询是否为空\n      if (!searchQuery.value.trim()) {\n        // 如果为空，直接展示所有历史数据\n        filteredHistoricalData.value = historicalData.value;\n        return;\n      }\n\n      // 根据关键词过滤历史数据\n      filteredHistoricalData.value = historicalData.value.filter(item => item.goodName.toLowerCase().includes(searchQuery.value.toLowerCase())).map(item => ({\n        status: item.status,\n        uplodatime: item.uplodatime,\n        location: item.location,\n        shopID: item.shopID,\n        goodName: item.goodName,\n        comments: item.comments,\n        price: item.price,\n        goodID: item.goodID,\n        showURL: item.showURL\n      }));\n    }\n    async function init() {\n      try {\n        const response = await axios.post('/api/good/findFavourite', {\n          userId: UserInfoForm.value.id\n        }, {\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          withCredentials: true\n        });\n        if (response.data !== null) {\n          historicalData.value = response.data;\n          filteredHistoricalData.value = historicalData.value;\n        }\n      } catch (err) {\n        ElMessage.error(\"获取收藏数据失败\");\n      }\n    }\n    async function DeleteProduct(goodID) {\n      try {\n        const response = await axios.post('/api/good/deleteFavourite', {\n          userId: UserInfoForm.value.id,\n          goodId: goodID\n        }, {\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          withCredentials: true\n        });\n        if (response.data.code === 200) {\n          await init();\n        } else if (response.data.code === 400) {\n          ElMessage.error(\"取消收藏失败1\");\n        }\n      } catch (error) {\n        ElMessage.error(\"取消收藏失败\");\n      }\n    }\n    onMounted(async () => {\n      initUserSession();\n      await init();\n      initSidebar();\n    });\n    const __returned__ = {\n      UserInfoForm,\n      initUserSession,\n      sidebarComponent,\n      initSidebar,\n      handleProductDetail,\n      historicalData,\n      searchQuery,\n      filteredHistoricalData,\n      filterProducts,\n      init,\n      DeleteProduct,\n      HeaderComponent,\n      get router() {\n        return router;\n      },\n      FooterComponent,\n      RightWidgetComponent,\n      onMounted,\n      ref,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get axios() {\n        return axios;\n      },\n      SidebarComponent,\n      get useUser() {\n        return useUser;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["HeaderComponent","router","FooterComponent","RightWidgetComponent","onMounted","ref","ElMessage","axios","SidebarComponent","useUser","UserInfoForm","initUserSession","sidebarComponent","initSidebar","value","setActive","handleProductDetail","product","push","goodID","historicalData","searchQuery","filteredHistoricalData","filterProducts","trim","filter","item","goodName","toLowerCase","includes","map","status","uplodatime","location","shopID","comments","price","showURL","init","response","post","userId","id","headers","withCredentials","data","err","error","DeleteProduct","goodId","code"],"sources":["D:/Cache/Java/shopping/shoppping_c_frontend/src/views/MyFavoriteView.vue"],"sourcesContent":["<template>\r\n  <div class=\"my-haichao-page\">\r\n    <HeaderComponent/>\r\n    <SidebarComponent ref=\"sidebarComponent\"/>\r\n\r\n    <div class=\"main-content\">\r\n      <div class=\"search-container\">\r\n        <el-input type=\"text\" v-model=\"searchQuery\" placeholder=\"搜索宝贝...\" class=\"search-input\"\r\n                  @keyup.enter=\"filterProducts\"/>\r\n        <button @click=\"filterProducts\" class=\"search-button\">\r\n          <a class=\"bi bi-search\" style=\"color:whitesmoke;\"></a>\r\n        </button>\r\n      </div>\r\n      <div class=\"product-list\">\r\n        <div class=\"product-card\" @click=\"handleProductDetail(item)\" v-for=\"item in filteredHistoricalData\"\r\n             :key=\"item.goodID\">\r\n          <img :src=\"item.showURL\" alt=\"product image\" class=\"product-image\"/>\r\n          <div class=\"product-info\">\r\n            <p class=\"product-title\">{{ item.goodName }}</p>\r\n            <p class=\"product-price\" v-if=\"item.status\">￥{{ item.price }}</p>\r\n            <p class=\"product-price\" style=\"color: #4c4c4c;\" v-else>\r\n              <a class=\"bi bi-x-circle-fill\" style=\"color: #4c4c4c;\"></a>已下架\r\n            </p>\r\n          </div>\r\n          <div class=\"button-container\">\r\n            <button @click.stop=\"handleProductDetail(item)\">进入店铺</button>\r\n            <button @click.stop=\"findSimilar(item)\">按图找相似</button>\r\n          </div>\r\n          <div class=\"trash-icon\" @click=\"(event) => { event.stopPropagation(); DeleteProduct(item.goodID); }\">\r\n            <img src=\"@/images/Trash_icon.png\" alt=\"Trash Icon\" class=\"trash-image\"/>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <FooterComponent/>\r\n  <RightWidgetComponent/>\r\n</template>\r\n\r\n<script setup>\r\nimport HeaderComponent from \"@/components/HeaderComponent.vue\";\r\nimport router from \"@/router\";\r\nimport FooterComponent from \"@/components/FooterComponent.vue\";\r\nimport RightWidgetComponent from \"@/components/RightWidgetComponent.vue\";\r\nimport {onMounted, ref} from 'vue';\r\nimport {ElMessage} from \"element-plus\";\r\nimport axios from 'axios';\r\nimport SidebarComponent from \"@/components/SidebarComponent.vue\";\r\nimport useUser from \"@/composables/useUser\";\r\n\r\nconst {UserInfoForm, initUserSession} = useUser()\r\n\r\nconst sidebarComponent = ref(null);\r\n\r\nfunction initSidebar() {\r\n  sidebarComponent.value.setActive(7);\r\n}\r\n\r\nfunction handleProductDetail(product) {\r\n  router.push('/goodDetail?id=' + product.goodID);\r\n}\r\n\r\nconst historicalData = ref([]);\r\nconst searchQuery = ref('');\r\nconst filteredHistoricalData = ref([]);\r\n\r\nfunction filterProducts() {\r\n  // 检查搜索查询是否为空\r\n  if (!searchQuery.value.trim()) {\r\n    // 如果为空，直接展示所有历史数据\r\n    filteredHistoricalData.value = historicalData.value;\r\n    return;\r\n  }\r\n\r\n  // 根据关键词过滤历史数据\r\n  filteredHistoricalData.value = historicalData.value\r\n      .filter(item => item.goodName.toLowerCase().includes(searchQuery.value.toLowerCase()))\r\n      .map(item => ({\r\n        status: item.status,\r\n        uplodatime: item.uplodatime,\r\n        location: item.location,\r\n        shopID: item.shopID,\r\n        goodName: item.goodName,\r\n        comments: item.comments,\r\n        price: item.price,\r\n        goodID: item.goodID,\r\n        showURL: item.showURL\r\n      }));\r\n}\r\n\r\nasync function init() {\r\n  try {\r\n    const response = await axios.post('/api/good/findFavourite', {\r\n      userId: UserInfoForm.value.id\r\n    }, {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\"\r\n      },\r\n      withCredentials: true\r\n    });\r\n    if (response.data !== null) {\r\n      historicalData.value = response.data;\r\n      filteredHistoricalData.value = historicalData.value;\r\n    }\r\n  } catch (err) {\r\n    ElMessage.error(\"获取收藏数据失败\")\r\n  }\r\n}\r\n\r\nasync function DeleteProduct(goodID) {\r\n  try {\r\n    const response = await axios.post('/api/good/deleteFavourite', {\r\n      userId: UserInfoForm.value.id,\r\n      goodId: goodID\r\n    }, {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\"\r\n      },\r\n      withCredentials: true\r\n    })\r\n    if (response.data.code === 200) {\r\n      await init();\r\n    } else if (response.data.code === 400) {\r\n      ElMessage.error(\"取消收藏失败1\")\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error(\"取消收藏失败\")\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  initUserSession();\r\n  await init();\r\n  initSidebar();\r\n});\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.my-haichao-page {\r\n  display: flex;\r\n  flex-direction: row;\r\n  font-family: Arial, sans-serif;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.main-content {\r\n  flex: 1;\r\n  padding: 20px;\r\n  background-color: #ffffff;\r\n  margin-top: 90px;\r\n  min-height: calc(90vh - 100px);\r\n}\r\n\r\n.search-box {\r\n  margin-bottom: 20px;\r\n  padding: 10px;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.history-section {\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.product-list {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 20px;\r\n}\r\n\r\n.product-list > div {\r\n  flex-basis: calc(20% - 20px); /* 每个子元素占据 25% 的宽度，减去间距 */\r\n}\r\n\r\n.product-card {\r\n  width: 200px;\r\n  background-color: #fff;\r\n  border: 1px solid #eaeaea;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  overflow: hidden;\r\n  transition: transform 0.3s;\r\n  position: relative;\r\n}\r\n\r\n.product-card:hover {\r\n  transform: translateY(-5px);\r\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);\r\n  border: 1px solid #e02020;\r\n}\r\n\r\n.product-image {\r\n  width: 100%;\r\n  height: 75%;\r\n  object-fit: cover;\r\n  border-radius: 8px;\r\n}\r\n\r\n.trash-icon {\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  display: none; /* 默认隐藏 */\r\n  background-color: rgba(0, 0, 0, 0.6);\r\n  border-radius: 0 0 0 8px;\r\n}\r\n\r\n.product-card:hover .trash-icon {\r\n  display: block; /* 悬浮时显示 */\r\n}\r\n\r\n.trash-image {\r\n  width: 30px;\r\n  height: 30px;\r\n  padding: 5px;\r\n  /* 其他样式 */\r\n}\r\n\r\n.product-info {\r\n  padding: 10px;\r\n}\r\n\r\n.product-title {\r\n  font-size: 14px;\r\n  color: #333;\r\n  margin: 5px 0;\r\n}\r\n\r\n.product-price {\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  color: #ff0000;\r\n}\r\n\r\n.search-container {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n  padding-right: 20px;\r\n}\r\n\r\n.search-input {\r\n  padding: 10px;\r\n  font-size: 16px;\r\n  border: 2px solid #ccc;\r\n  border-radius: 8px 0 0 8px;\r\n  outline: none;\r\n  width: 200px;\r\n  border-right: none;\r\n}\r\n\r\n.search-input:hover {\r\n  border-color: #e02020;\r\n}\r\n\r\n.search-button {\r\n  padding: 10px 20px;\r\n  background-color: #e02020;\r\n  color: white;\r\n  font-size: 16px;\r\n  border: 2px solid #e02020;\r\n  border-radius: 0 8px 8px 0;\r\n  cursor: pointer;\r\n  font-weight: bold;\r\n}\r\n\r\n.search-button:hover {\r\n  background-color: #c21a1a;\r\n  border-color: #c21a1a;\r\n}\r\n\r\n.night-mode {\r\n  background-color: #2e2e2e;\r\n  color: #e0e0e0;\r\n}\r\n\r\n.night-mode .body {\r\n  background-color: #2e2e2e;\r\n}\r\n\r\n.night-mode .header {\r\n  background-color: #3c3c3c;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.night-mode .sidebar {\r\n  background-color: #3c3c3c;\r\n  border-right: 1px solid #444;\r\n}\r\n\r\n.night-mode .sidebar .el-menu-item {\r\n  background-color: #3c3c3c;\r\n  color: #e0e0e0;\r\n}\r\n\r\n.night-mode .sidebar.el-menu-item:hover {\r\n  background-color: #4c4c4c;\r\n}\r\n\r\n.night-mode .main-content,\r\n.night-mode .profile-section,\r\n.night-mode .order-section,\r\n.night-mode .logistics-section,\r\n.night-mode .logistics-item,\r\n.night-mode .profile-card,\r\n.night-mode .promotion-card {\r\n  background-color: #3c3c3c;\r\n  color: #e0e0e0;\r\n}\r\n\r\n.night-mode .order-icon,\r\n.night-mode .logistics-action {\r\n  color: #ffa500;\r\n}\r\n\r\n.night-mode .right-widget {\r\n  background-color: #3c3c3c;\r\n  box-shadow: -2px 0 8px rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.night-mode .footer {\r\n  background-color: #2e2e2e;\r\n  border-top: 1px solid #333;\r\n}\r\n\r\n.night-mode .footer-links a {\r\n  color: #ffffff;\r\n}\r\n\r\n.night-mode .footer-links a:hover {\r\n  color: #e02020;\r\n}\r\n\r\n.night-mode .product-card {\r\n  background-color: #3c3c3c;\r\n}\r\n\r\n.night-mode .search-input {\r\n  background-color: #3c3c3c;\r\n  color: #e0e0e0;\r\n}\r\n\r\n.button-container {\r\n  position: absolute;\r\n  width: 100%;\r\n  top: 66%;\r\n  display: none; /* 默认隐藏 */\r\n  background-color: rgba(0, 0, 0, 0.6);\r\n  justify-content: space-between;\r\n  padding: 5px 0;\r\n}\r\n\r\n.product-card:hover .button-container {\r\n  display: block; /* 悬浮时显示 */\r\n}\r\n\r\n.button-container button {\r\n  background-color: transparent;\r\n  color: white;\r\n  border: none;\r\n  padding: 10px 10px;\r\n  cursor: pointer;\r\n  border-radius: 5px;\r\n  font-size: 18px;\r\n}\r\n\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}